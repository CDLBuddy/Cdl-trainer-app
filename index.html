<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>CDL Trainer</title>
  <meta name="description" content="CDL Trainer â€“ Your AI-powered CDL training app with quizzes, checklists, walkthroughs, and more." />
  <meta name="theme-color" content="#003366" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />

  <!-- Manifest & Icons -->
  <link rel="manifest" href="manifest.json" />
  <link rel="icon" href="favicon.ico" />
  <link rel="apple-touch-icon" sizes="192x192" href="icons/icon-192.png" />
  <link rel="apple-touch-icon" sizes="512x512" href="icons/icon-512.png" />

  <!-- Mobile PWA Meta -->
  <meta name="mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
  <meta name="apple-mobile-web-app-title" content="CDL Trainer" />

  <!-- Security & Performance -->
  <meta http-equiv="Content-Security-Policy"
        content="default-src 'self'; script-src 'self' https://www.gstatic.com; style-src 'self' 'unsafe-inline'; img-src 'self' data: blob:; connect-src *;" />

  <!-- Styles -->
  <link rel="stylesheet" href="style.css" />
</head>
<body role="application">

  <!-- JavaScript Load Warning -->
  <div id="js-error" style="color:red; text-align:center; margin-top:2rem;">
    âš ï¸ JavaScript failed to load. Please check your internet connection or try refreshing.
  </div>

  <!-- Loading Fallback -->
  <div id="loading-screen" aria-hidden="false" aria-live="polite" style="text-align:center; padding:2rem; display:none;">
    <div class="loading-spinner" style="margin: 20px auto;"></div>
    <h2>Loading CDL Trainer...</h2>
    <p>Preparing your dashboard...</p>
  </div>

  <!-- Main App Container -->
  <main id="app" role="main" tabindex="-1"></main>

  <!-- Theme / Voice Controls -->
  <aside style="text-align: center; margin-top: 1rem;">
    <button id="mic-button" title="Voice Login" aria-label="Voice Login" style="display: none;">ğŸ™ï¸</button>
    <button id="theme-toggle" title="Toggle Theme" aria-label="Toggle Dark Mode">ğŸŒ“ Theme</button>
  </aside>

  <!-- Language Selector -->
  <div id="language-selector-container" style="text-align:center; margin: 1rem 0;">
    <label for="language-selector" style="display:block; font-size: 0.9rem;">ğŸŒ Select Language:</label>
    <select id="language-selector" aria-label="Select language">
      <option value="en" selected>ğŸ‡ºğŸ‡¸ English</option>
      <option value="es">ğŸ‡ªğŸ‡¸ EspaÃ±ol</option>
      <option value="fr">ğŸ‡«ğŸ‡· FranÃ§ais</option>
      <option value="de">ğŸ‡©ğŸ‡ª Deutsch</option>
      <option value="zh">ğŸ‡¨ğŸ‡³ ä¸­æ–‡</option>
    </select>
  </div>

  <!-- App Logic -->
  <script type="module" src="app.js"></script>

  <!-- No JavaScript Fallback -->
  <noscript>
    <div style="padding:2rem; text-align:center;">
      <strong>âš ï¸ JavaScript is required to run CDL Trainer. Please enable it in your browser settings.</strong>
    </div>
  </noscript>

  <!-- Service Worker -->
  <script>
    if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
        navigator.serviceWorker.register('service-worker.js')
          .then(reg => console.log('âœ… Service Worker registered:', reg.scope))
          .catch(err => console.warn('âŒ Service Worker registration failed:', err));
      });
    }

    // Hide JS error if script loaded successfully
    window.addEventListener('DOMContentLoaded', () => {
      const jsError = document.getElementById('js-error');
      if (jsError) jsError.style.display = 'none';
    });
  </script>

</body>
</html>